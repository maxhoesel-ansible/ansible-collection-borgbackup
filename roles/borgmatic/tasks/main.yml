---
# tasks file for borgmatic

- name: Verify that required parameters are set
  assert:
    that:
      - borgmatic_location_source_directories is defined
      - borgmatic_location_source_directories | length > 0
      - borgmatic_location_repositories is defined
      - borgmatic_location_repositories | length > 0
  when: borgmatic_setup_backup

- include: install.yml
  when: borgmatic_install

- block:
  - include: ssh.yml
  - include: config.yml
    when: borgmatic_manage_config
  - include: schedule.yml
    when: borgmatic_manage_schedule
  when: borgmatic_setup_backup
